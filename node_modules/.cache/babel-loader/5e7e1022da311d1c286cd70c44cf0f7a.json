{"ast":null,"code":"import _slicedToArray from\"/Users/huanwen/Work/Cook/cook-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{Modal}from'@aragon/ui';import BigNumber from'bignumber.js';import{BalanceBlock}from'../common/index';import{approve,stake}from'../../utils/web3';import{isPos,toBaseUnitBN}from'../../utils/number';import{UNI}from\"../../constants/tokens\";import BigNumberInput from\"../common/BigNumberInput\";import ActionButton from\"../common/ActionButton\";import colors from'../../constants/colors';import{Container,Row,Col}from'react-grid-system';import ListTable from\"../PoolList/ListTable\";function Stake(_ref){var user=_ref.user,poolAddress=_ref.poolAddress,staked=_ref.staked,balance=_ref.balance,allowance=_ref.allowance,pools=_ref.pools;var _useState=useState(new BigNumber(0)),_useState2=_slicedToArray(_useState,2),stakeAmount=_useState2[0],setStakeAmount=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),opened=_useState4[0],setOpened=_useState4[1];return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(ActionButton,{label:\"DEPOSIT\",color:colors.button,onClick:function onClick(){setOpened(true);},disabled:poolAddress===''||user===''}),/*#__PURE__*/React.createElement(Modal,{visible:opened,onClose:function onClose(){return setOpened(false);}},/*#__PURE__*/React.createElement(Container,{style:{flexBasis:'100%',paddingTop:'5%'}},/*#__PURE__*/React.createElement(ListTable,{pools:pools,selectedPool:poolAddress}),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{sm:12,xl:12},/*#__PURE__*/React.createElement(BalanceBlock,{asset:\"Balance\",balance:balance,suffix:\"UNI-V2\",type:\"row\"})),/*#__PURE__*/React.createElement(Col,{sm:12,xl:12},/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(BigNumberInput,{adornment:\"UNI-V2\",value:stakeAmount,setter:setStakeAmount,max:function max(){setStakeAmount(balance);}}))),allowance.comparedTo(stakeAmount)>0?/*#__PURE__*/React.createElement(Col,{md:12,xl:12,style:{textAlign:\"center\"}},/*#__PURE__*/React.createElement(ActionButton,{label:\"DEPOSIT\",color:colors.button,onClick:function onClick(){stake(poolAddress,toBaseUnitBN(stakeAmount,UNI.decimals),function(hash){setStakeAmount(new BigNumber(0));setOpened(false);});},disabled:poolAddress===''||user===''||!isPos(stakeAmount)||stakeAmount.isGreaterThan(balance)})):/*#__PURE__*/React.createElement(Col,{sm:12,xl:12,style:{textAlign:\"center\"}},/*#__PURE__*/React.createElement(ActionButton,{label:\"APPROVE\",color:colors.button,onClick:function onClick(){approve(UNI.addr,poolAddress);},disabled:poolAddress===''||user===''}))))));}export default Stake;","map":{"version":3,"sources":["/Users/huanwen/Work/Cook/cook-frontend/src/components/Pool/Stake.tsx"],"names":["React","useState","Modal","BigNumber","BalanceBlock","approve","stake","isPos","toBaseUnitBN","UNI","BigNumberInput","ActionButton","colors","Container","Row","Col","ListTable","Stake","user","poolAddress","staked","balance","allowance","pools","stakeAmount","setStakeAmount","opened","setOpened","button","flexBasis","paddingTop","comparedTo","textAlign","decimals","hash","isGreaterThan","addr"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { Modal } from '@aragon/ui';\nimport BigNumber from 'bignumber.js';\nimport { BalanceBlock } from '../common/index';\nimport {approve, stake} from '../../utils/web3';\nimport {isPos, toBaseUnitBN} from '../../utils/number';\nimport {UNI} from \"../../constants/tokens\";\nimport BigNumberInput from \"../common/BigNumberInput\";\nimport ActionButton from \"../common/ActionButton\";\nimport colors from '../../constants/colors';\nimport { Container, Row, Col } from 'react-grid-system';\nimport ListTable from \"../PoolList/ListTable\";\n\ntype StakeProps = {\n  user: string,\n  poolAddress: string,\n  balance: BigNumber,\n  allowance: BigNumber,\n  staked: BigNumber\n  pools?: Array<any>\n};\n\nfunction Stake({\n  user, poolAddress,\n  staked, balance, allowance,pools\n}: StakeProps) {\n  const [stakeAmount, setStakeAmount] = useState(new BigNumber(0));\n  const [opened, setOpened] = useState(false)\n  return (\n    <div>\n    <ActionButton\n      label={\"DEPOSIT\"}\n      color={colors.button}\n      onClick={() => {\n        setOpened(true)\n      }}\n      disabled={poolAddress === '' || user === ''}\n    />\n    <Modal visible={opened} onClose={()=>setOpened(false)}>\n    <Container style={{flexBasis: '100%', paddingTop: '5%'}}>\n      <ListTable pools={pools} selectedPool={poolAddress}/>\n      <Row >\n        <Col sm={12} xl={12}>\n          <BalanceBlock asset=\"Balance\" balance={balance} suffix={\"UNI-V2\"} type={\"row\"}/>\n        </Col>\n        <Col sm={12} xl={12}>\n\n              <>\n                <BigNumberInput\n                  adornment=\"UNI-V2\"\n                  value={stakeAmount}\n                  setter={setStakeAmount}\n                  max={() => {\n                    setStakeAmount(balance);\n                  }}\n                />\n                \n              </>\n            </Col>\n            {allowance.comparedTo(stakeAmount) > 0 ?\n            <Col md={12} xl={12} style={{textAlign:\"center\"}}>\n              <ActionButton\n                label={\"DEPOSIT\"}\n                color={colors.button}\n                onClick={() => {\n                  stake(\n                    poolAddress,\n                    toBaseUnitBN(stakeAmount, UNI.decimals),\n                    (hash) => {\n                      setStakeAmount(new BigNumber(0))\n                      setOpened(false)\n                    }\n                  );\n                }}\n                disabled={poolAddress === '' || user === '' || !isPos(stakeAmount) || stakeAmount.isGreaterThan(balance)}\n              />\n            </Col>\n            :\n            <Col sm={12} xl={12} style={{textAlign:\"center\"}}>\n              <ActionButton\n                label={\"APPROVE\"}\n                color={colors.button}\n                onClick={() => {\n                  approve(UNI.addr, poolAddress);\n                }}\n                disabled={poolAddress === '' || user === ''}\n              />\n            </Col>\n            }\n            </Row>\n          </Container>\n\n    </Modal>\n    </div>\n  );\n}\n\nexport default Stake;\n"]},"metadata":{},"sourceType":"module"}