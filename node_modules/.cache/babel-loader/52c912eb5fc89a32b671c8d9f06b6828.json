{"ast":null,"code":"import _regeneratorRuntime from\"/Users/huanwen/Work/Cook/cook-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/huanwen/Work/Cook/cook-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/huanwen/Work/Cook/cook-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useParams}from'react-router-dom';import{getTodayNumber,getDistributionStartTimestamp}from'../../utils/infura';import{setDay}from'../../utils/web3';import{Box,Button,IconCirclePlus}from'@aragon/ui';import BigNumber from'bignumber.js';import{NumberBlock}from'../common/index';import BigNumberInput from\"../common/BigNumberInput\";function SetDay(_ref){var user=_ref.user,cookDistribution=_ref.cookDistribution;var _useParams=useParams(),override=_useParams.override;if(override){user=override;}var _useState=useState(new BigNumber(0)),_useState2=_slicedToArray(_useState,2),startDay=_useState2[0],setStartDay=_useState2[1];var _useState3=useState(new BigNumber(0)),_useState4=_slicedToArray(_useState3,2),today=_useState4[0],setToday=_useState4[1];var _useState5=useState(new BigNumber(0)),_useState6=_slicedToArray(_useState5,2),dayNumber=_useState6[0],setDayNumber=_useState6[1];//Update User balances\nuseEffect(function(){var isCancelled=false;function updateUserInfo(){return _updateUserInfo.apply(this,arguments);}function _updateUserInfo(){_updateUserInfo=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$Promise$all,_yield$Promise$all2,startTimeStamp,tDay,startDay,todayNumber;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Promise.all([getDistributionStartTimestamp(cookDistribution),getTodayNumber(cookDistribution)]);case 2:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);startTimeStamp=_yield$Promise$all2[0];tDay=_yield$Promise$all2[1];startDay=new BigNumber(startTimeStamp).div(86400).decimalPlaces(0,1);todayNumber=new BigNumber(tDay);if(!isCancelled){setStartDay(new BigNumber(startDay));setToday(new BigNumber(todayNumber));}case 9:case\"end\":return _context.stop();}}},_callee);}));return _updateUserInfo.apply(this,arguments);}updateUserInfo();var id=setInterval(updateUserInfo,1000);// eslint-disable-next-line consistent-return\nreturn function(){isCancelled=true;clearInterval(id);};},[user,cookDistribution]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Box,{heading:\"CookDistributionDay\"},/*#__PURE__*/React.createElement(\"div\",{style:{width:'100%',paddingTop:'2%'}},/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex'}},/*#__PURE__*/React.createElement(\"div\",{style:{flexBasis:'32%'}},/*#__PURE__*/React.createElement(NumberBlock,{title:\"Startday Number\",num:startDay})),/*#__PURE__*/React.createElement(\"div\",{style:{flexBasis:'32%'}},/*#__PURE__*/React.createElement(NumberBlock,{title:\"Today Number\",num:today})),/*#__PURE__*/React.createElement(\"div\",{style:{width:'60%'}},/*#__PURE__*/React.createElement(BigNumberInput,{adornment:\"Day\",value:dayNumber,setter:setDayNumber})),/*#__PURE__*/React.createElement(\"div\",{style:{width:'40%'}},/*#__PURE__*/React.createElement(Button,{wide:true,icon:/*#__PURE__*/React.createElement(IconCirclePlus,null),label:\"Set\",onClick:function onClick(){setDay(cookDistribution,dayNumber);}}))))));}export default SetDay;","map":{"version":3,"sources":["/Users/huanwen/Work/Cook/cook-frontend/src/components/Admin/SetDay.tsx"],"names":["React","useState","useEffect","useParams","getTodayNumber","getDistributionStartTimestamp","setDay","Box","Button","IconCirclePlus","BigNumber","NumberBlock","BigNumberInput","SetDay","user","cookDistribution","override","startDay","setStartDay","today","setToday","dayNumber","setDayNumber","isCancelled","updateUserInfo","Promise","all","startTimeStamp","tDay","div","decimalPlaces","todayNumber","id","setInterval","clearInterval","width","paddingTop","display","flexBasis"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams } from 'react-router-dom';\n\nimport {\n  getTodayNumber, getDistributionStartTimestamp\n} from '../../utils/infura';\nimport {\n  setDay\n} from '../../utils/web3';\nimport {\n  Box, Button, IconCirclePlus\n} from '@aragon/ui';\nimport BigNumber from 'bignumber.js';\nimport {\n  NumberBlock,\n} from '../common/index';\nimport BigNumberInput from \"../common/BigNumberInput\";\n\nfunction SetDay({ user, cookDistribution }: {user: string, cookDistribution: string}) {\n  const { override } = useParams();\n  if (override) {\n    user = override;\n  }\n\n\n  const [startDay, setStartDay] = useState(new BigNumber(0));\n  const [today, setToday] = useState(new BigNumber(0));\n  const [dayNumber, setDayNumber] = useState(new BigNumber(0));\n\n  //Update User balances\n  useEffect(() => {\n    let isCancelled = false;\n\n    async function updateUserInfo() {\n      const [\n        startTimeStamp,\n        tDay\n      ] = await Promise.all([\n        getDistributionStartTimestamp(cookDistribution),\n        getTodayNumber(cookDistribution)\n      ]);\n\n      const startDay = new BigNumber(startTimeStamp).div(86400).decimalPlaces(0, 1);\n      const todayNumber = new BigNumber(tDay);\n\n      if (!isCancelled) {\n        setStartDay(new BigNumber(startDay));\n        setToday(new BigNumber(todayNumber));\n      }\n    }\n    updateUserInfo();\n    const id = setInterval(updateUserInfo, 1000);\n\n    // eslint-disable-next-line consistent-return\n    return () => {\n      isCancelled = true;\n      clearInterval(id);\n    };\n  }, [user, cookDistribution]);\n\n  return (\n    <>\n       <Box heading=\"CookDistributionDay\">\n       <div style={{width: '100%', paddingTop: '2%'}}>\n         <div style={{display: 'flex'}}>\n           <div style={{flexBasis: '32%'}}>\n             <NumberBlock title=\"Startday Number\" num={startDay}/>\n           </div>\n           <div style={{flexBasis: '32%'}}>\n             <NumberBlock title=\"Today Number\" num={today}/>\n           </div>\n           <div style={{width: '60%'}}>\n               <BigNumberInput\n                 adornment=\"Day\"\n                 value={dayNumber}\n                 setter={setDayNumber}\n               />\n           </div>\n           <div style={{width: '40%'}}>\n             <Button\n               wide\n               icon={<IconCirclePlus/>}\n               label=\"Set\"\n               onClick={() => {\n                 setDay(\n                   cookDistribution,\n                   dayNumber\n                 );\n               }}\n             />\n           </div>\n         </div>\n       </div>\n\n      </Box>\n    </>\n  );\n}\n\nexport default SetDay;\n"]},"metadata":{},"sourceType":"module"}