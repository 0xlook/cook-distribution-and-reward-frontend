{"ast":null,"code":"var _jsxFileName = \"/Users/huanwen/Work/cook-frontend/src/components/Admin/SetPrice.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { getWETHPrice, getSevenMAPrice } from '../../utils/infura';\nimport { setCookPrice, setWETHPrice, updatePriceFeed } from '../../utils/web3';\nimport { Box, Button, IconCirclePlus } from '@aragon/ui';\nimport { toBaseUnitBN, toTokenUnitsBN } from '../../utils/number';\nimport BigNumber from 'bignumber.js';\nimport { BalanceBlock } from '../common/index';\nimport BigNumberInput from \"../common/BigNumberInput\";\n\nfunction SetPrice({\n  user,\n  oracle,\n  priceComsumer,\n  cookDistribution\n}) {\n  const {\n    override\n  } = useParams();\n\n  if (override) {\n    user = override;\n  }\n\n  const [currentCookPrice, setCurrentCookPrice] = useState(new BigNumber(0));\n  const [currentWethPrice, setCurrentWethPrice] = useState(new BigNumber(0));\n  const [targetCookPrice, setTargetCookPrice] = useState(new BigNumber(0));\n  const [targetWethPrice, setTargetWethPrice] = useState(new BigNumber(0));\n  const [sevenMA, setSevenMA] = useState(new BigNumber(0));\n  const [oraclePrice, setOraclePrice] = useState(new BigNumber(0)); //Update User balances\n\n  useEffect(() => {\n    if (user === '') {\n      setCurrentCookPrice(new BigNumber(0));\n      setCurrentWethPrice(new BigNumber(0));\n      setTargetCookPrice(new BigNumber(0));\n      setTargetWethPrice(new BigNumber(0));\n      setSevenMA(new BigNumber(0));\n      setOraclePrice(new BigNumber(0));\n      return;\n    }\n\n    let isCancelled = false;\n\n    async function updateUserInfo() {\n      const [wethP] = await Promise.all([getWETHPrice(priceComsumer)]);\n      const currentWETHPrice = toTokenUnitsBN(wethP, 8);\n\n      if (!isCancelled) {\n        setCurrentWethPrice(currentWETHPrice);\n      }\n    }\n\n    updateUserInfo();\n    const id = setInterval(updateUserInfo, 1000); // eslint-disable-next-line consistent-return\n\n    return () => {\n      isCancelled = true;\n      clearInterval(id);\n    };\n  }, [user, oracle, priceComsumer, cookDistribution]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Box, {\n    heading: \"Cook Price\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '100%',\n      paddingTop: '2%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 8\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 10\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flexBasis: '32%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 12\n    }\n  }, /*#__PURE__*/React.createElement(BalanceBlock, {\n    asset: \"COOK/WETH\",\n    balance: currentCookPrice.toString(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 14\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '60%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 12\n    }\n  }, /*#__PURE__*/React.createElement(BigNumberInput, {\n    adornment: \"WETH\",\n    value: targetCookPrice,\n    setter: setTargetCookPrice,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 16\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '40%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 12\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    wide: true,\n    icon: /*#__PURE__*/React.createElement(IconCirclePlus, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 22\n      }\n    }),\n    label: \"Set\",\n    onClick: () => {\n      setCookPrice(oracle, toBaseUnitBN(targetCookPrice, 18));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 14\n    }\n  }))))), /*#__PURE__*/React.createElement(Box, {\n    heading: \"Price\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '100%',\n      paddingTop: '2%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flexBasis: '32%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(BalanceBlock, {\n    asset: \"WETH/USDC\",\n    balance: currentWethPrice.toString(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '60%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(BigNumberInput, {\n    adornment: \"USDC\",\n    value: targetWethPrice,\n    setter: setTargetWethPrice,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '40%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    wide: true,\n    icon: /*#__PURE__*/React.createElement(IconCirclePlus, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 21\n      }\n    }),\n    label: \"Set\",\n    onClick: () => {\n      setWETHPrice(priceComsumer, toBaseUnitBN(targetWethPrice, 8));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 13\n    }\n  }))))), /*#__PURE__*/React.createElement(Box, {\n    heading: \"7MA\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '100%',\n      paddingTop: '2%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flexBasis: '32%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(BalanceBlock, {\n    asset: \"COOK/USDC\",\n    balance: sevenMA.toString(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '40%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    wide: true,\n    icon: /*#__PURE__*/React.createElement(IconCirclePlus, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 21\n      }\n    }),\n    label: \"Get 7MA\",\n    onClick: async () => {\n      const ssma = await getSevenMAPrice(cookDistribution);\n      setSevenMA(toTokenUnitsBN(ssma, 8));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 13\n    }\n  }))))), /*#__PURE__*/React.createElement(Box, {\n    heading: \"Update Price Feed\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '100%',\n      paddingTop: '2%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flexBasis: '32%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(BalanceBlock, {\n    asset: \"COOK/WETH\",\n    balance: oraclePrice.toString(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '40%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    wide: true,\n    icon: /*#__PURE__*/React.createElement(IconCirclePlus, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 21\n      }\n    }),\n    label: \"Update Price Feed\",\n    onClick: () => {\n      updatePriceFeed(cookDistribution);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 13\n    }\n  }))))));\n}\n\nexport default SetPrice;","map":{"version":3,"sources":["/Users/huanwen/Work/cook-frontend/src/components/Admin/SetPrice.tsx"],"names":["React","useState","useEffect","useParams","getWETHPrice","getSevenMAPrice","setCookPrice","setWETHPrice","updatePriceFeed","Box","Button","IconCirclePlus","toBaseUnitBN","toTokenUnitsBN","BigNumber","BalanceBlock","BigNumberInput","SetPrice","user","oracle","priceComsumer","cookDistribution","override","currentCookPrice","setCurrentCookPrice","currentWethPrice","setCurrentWethPrice","targetCookPrice","setTargetCookPrice","targetWethPrice","setTargetWethPrice","sevenMA","setSevenMA","oraclePrice","setOraclePrice","isCancelled","updateUserInfo","wethP","Promise","all","currentWETHPrice","id","setInterval","clearInterval","width","paddingTop","display","flexBasis","toString","ssma"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams } from 'react-router-dom';\n\nimport {\n  getWETHPrice,getSevenMAPrice\n} from '../../utils/infura';\nimport {\n  setCookPrice, setWETHPrice, updatePriceFeed\n} from '../../utils/web3';\nimport {\n  Box, Button, IconCirclePlus\n} from '@aragon/ui';\nimport {toBaseUnitBN,toTokenUnitsBN} from '../../utils/number';\nimport BigNumber from 'bignumber.js';\nimport {\n  BalanceBlock\n} from '../common/index';\nimport BigNumberInput from \"../common/BigNumberInput\";\n\nfunction SetPrice({ user, oracle, priceComsumer, cookDistribution }: {user: string, oracle: string, priceComsumer: string, cookDistribution: string}) {\n  const { override } = useParams();\n  if (override) {\n    user = override;\n  }\n\n\n  const [currentCookPrice, setCurrentCookPrice] = useState(new BigNumber(0));\n  const [currentWethPrice, setCurrentWethPrice] = useState(new BigNumber(0));\n\n  const [targetCookPrice, setTargetCookPrice] = useState(new BigNumber(0));\n  const [targetWethPrice, setTargetWethPrice] = useState(new BigNumber(0));\n\n  const [sevenMA, setSevenMA] = useState(new BigNumber(0));\n  const [oraclePrice, setOraclePrice] = useState(new BigNumber(0));\n\n  //Update User balances\n  useEffect(() => {\n    if (user === '') {\n      setCurrentCookPrice(new BigNumber(0));\n      setCurrentWethPrice(new BigNumber(0));\n      setTargetCookPrice(new BigNumber(0));\n      setTargetWethPrice(new BigNumber(0));\n      setSevenMA(new BigNumber(0));\n      setOraclePrice(new BigNumber(0));\n      return;\n    }\n    let isCancelled = false;\n\n    async function updateUserInfo() {\n      const [\n        wethP\n      ] = await Promise.all([\n\n        getWETHPrice(priceComsumer)\n      ]);\n\n      const currentWETHPrice = toTokenUnitsBN(wethP,8);\n\n\n      if (!isCancelled) {\n\n        setCurrentWethPrice(currentWETHPrice);\n      }\n    }\n    updateUserInfo();\n    const id = setInterval(updateUserInfo, 1000);\n\n    // eslint-disable-next-line consistent-return\n    return () => {\n      isCancelled = true;\n      clearInterval(id);\n    };\n  }, [user, oracle, priceComsumer, cookDistribution]);\n\n  return (\n    <>\n      <Box heading=\"Cook Price\">\n       <div style={{width: '100%', paddingTop: '2%'}}>\n         <div style={{display: 'flex'}}>\n           <div style={{flexBasis: '32%'}}>\n             <BalanceBlock asset=\"COOK/WETH\" balance={currentCookPrice.toString()}/>\n           </div>\n           <div style={{width: '60%'}}>\n               <BigNumberInput\n                 adornment=\"WETH\"\n                 value={targetCookPrice}\n                 setter={setTargetCookPrice}\n               />\n           </div>\n           <div style={{width: '40%'}}>\n             <Button\n               wide\n               icon={<IconCirclePlus/>}\n               label=\"Set\"\n               onClick={() => {\n                 setCookPrice(\n                   oracle,\n                   toBaseUnitBN(targetCookPrice,18)\n                 );\n               }}\n             />\n           </div>\n         </div>\n       </div>\n\n      </Box>\n      <Box heading=\"Price\">\n      <div style={{width: '100%', paddingTop: '2%'}}>\n        <div style={{display: 'flex'}}>\n          <div style={{flexBasis: '32%'}}>\n            <BalanceBlock asset=\"WETH/USDC\" balance={currentWethPrice.toString()}/>\n\n          </div>\n          <div style={{width: '60%'}}>\n              <BigNumberInput\n                adornment=\"USDC\"\n                value={targetWethPrice}\n                setter={setTargetWethPrice}\n              />\n          </div>\n          <div style={{width: '40%'}}>\n            <Button\n              wide\n              icon={<IconCirclePlus/>}\n              label=\"Set\"\n              onClick={() => {\n                setWETHPrice(\n                  priceComsumer,\n                  toBaseUnitBN(targetWethPrice,8)\n                );\n              }}\n            />\n          </div>\n        </div>\n      </div>\n\n      </Box>\n      <Box heading=\"7MA\">\n      <div style={{width: '100%', paddingTop: '2%'}}>\n        <div style={{display: 'flex'}}>\n          <div style={{flexBasis: '32%'}}>\n            <BalanceBlock asset=\"COOK/USDC\" balance={sevenMA.toString()}/>\n          </div>\n          <div style={{width: '40%'}}>\n            <Button\n              wide\n              icon={<IconCirclePlus/>}\n              label=\"Get 7MA\"\n              onClick={async() => {\n                const ssma = await getSevenMAPrice(cookDistribution);\n                setSevenMA(toTokenUnitsBN(ssma,8));\n              }}\n            />\n          </div>\n        </div>\n      </div>\n\n      </Box>\n      <Box heading=\"Update Price Feed\">\n      <div style={{width: '100%', paddingTop: '2%'}}>\n        <div style={{display: 'flex'}}>\n          <div style={{flexBasis: '32%'}}>\n            <BalanceBlock asset=\"COOK/WETH\" balance={oraclePrice.toString()}/>\n          </div>\n          <div style={{width: '40%'}}>\n            <Button\n              wide\n              icon={<IconCirclePlus/>}\n              label=\"Update Price Feed\"\n              onClick={() => {\n                updatePriceFeed(cookDistribution)\n              }}\n            />\n          </div>\n        </div>\n      </div>\n\n      </Box>\n    </>\n  );\n}\n\nexport default SetPrice;\n"]},"metadata":{},"sourceType":"module"}